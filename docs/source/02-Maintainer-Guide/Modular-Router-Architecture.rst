模块化路由架构
==============================================================================

概述
------------------------------------------------------------------------------

本项目采用 `FastAPI Bigger Applications <https://fastapi.tiangolo.com/tutorial/bigger-applications/>`_ 模式组织代码。核心思想是 **分层解耦**：

- **路由层 (routers/)**: 处理 HTTP 请求/响应，定义 API 端点
- **核心层 (core/)**: 应用配置、中间件、生命周期管理
- **业务层 (auth/ 等)**: 底层业务逻辑，与 HTTP 无关


目录职责
------------------------------------------------------------------------------

::

    learn_fastapi_auth/
    ├── routers/          # 路由定义 (视图层)
    │   └── *_routes.py   # 按领域划分的 APIRouter
    │
    ├── core/             # 应用核心
    │   ├── app_factory   # 应用工厂函数
    │   ├── middleware    # 中间件配置
    │   └── lifespan      # 启动/关闭逻辑
    │
    ├── auth/             # 业务逻辑 (不变)
    └── app.py            # 入口点 (仅调用工厂函数)


设计原则
------------------------------------------------------------------------------

1. **单一入口**: ``app.py`` 只负责创建应用实例，不包含业务代码
2. **路由模块化**: 每个 ``APIRouter`` 按领域划分，可独立测试
3. **中间件集中**: 所有中间件配置在 ``core/`` 中统一管理
4. **业务逻辑隔离**: ``auth/`` 等目录仅包含纯业务逻辑，不依赖 HTTP


扩展指南
------------------------------------------------------------------------------

**添加新 API 端点**:

1. 在 ``routers/`` 中创建或修改对应的路由模块
2. 使用 ``APIRouter`` 定义端点
3. 在 ``routers/__init__.py`` 中注册到主路由

**添加新中间件**:

1. 在 ``core/middleware.py`` 中添加配置函数
2. 在 ``setup_all_middleware()`` 中调用


参考资料
------------------------------------------------------------------------------

- `FastAPI Bigger Applications 官方文档 <https://fastapi.tiangolo.com/tutorial/bigger-applications/>`_
